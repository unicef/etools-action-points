<!--import [polymer/polymer-element, etools-ajax, iron-flex-layout/iron-flex-layout-classes]-->
<!--import [pages-header-element, page-layout-styles, main-page-styles, shared-styles, action-point-details,
            action-point-comments, action-points-history, status-element, error-handler-mixin]-->

<dom-module id="action-points-item">
    <template>
        <style include="page-layout-styles shared-styles main-page-styles iron-flex module-styles">
            #pageContent > * {
                display: block;
                margin-bottom: 25px;
            }
            .header-btn {
                color: var(--gray-mid);
                font-weight: 500;
                font-size: 14px;
            }
            .header-btn iron-icon {
                margin-right: 8px;
            }
        </style>
        <app-route
                route="{{route}}"
                pattern="/:id"
                data="{{routeData}}"></app-route>
        <div hidden$="[[!actionPoint.id]]">
            <pages-header-element
                    page-title="[[actionPoint.reference_number]]"
                    export-links="[[_setExportLinks(actionPoint)]]">
                <template is="dom-if" if="[[hasHistory(actionPoint.history)]]">
                    <paper-button icon="history" class="header-btn" on-tap="showHistory">
                        <iron-icon icon="history"></iron-icon>
                        History
                    </paper-button>
                </template>
            </pages-header-element>

            <div class="view-container">
                <div id="pageContent">
                    <action-point-details action-point="[[actionPoint]]" original-action-point="[[originalActionPoint]]" permission-path="[[permissionPath]]"></action-point-details>
                    <action-point-comments action-point="{{actionPoint}}" permission-path="[[permissionPath]]"></action-point-comments>
                </div>

                <div id="sidebar">
                    <status-element action-point="[[actionPoint]]" permission-path="[[permissionPath]]"></status-element>
                </div>
            </div>

            <etools-dialog
                    size="md"
                    no-padding
                    opened="{{isOpenedHistory}}"
                    dialog-title="History"
                    cancel-btn-text="Close"
                    hide-confirm-btn>
                <action-points-history history="[[actionPoint.history]]" permission-path="[[permissionPath]]"></action-points-history>
            </etools-dialog>
        </div>
    </template>
    <!-- inject scripts './action-points-item.js' -->
</dom-module>